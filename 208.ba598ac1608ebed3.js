"use strict";(self.webpackChunkSpike=self.webpackChunkSpike||[]).push([[208],{3208:(x,p,l)=>{l.r(p),l.d(p,{DesignRoutes:()=>S});var b=l(111),c=l(1806);const f=c.J1`
  mutation createDesign($design: NewDesign!) {
    createDesign(design: $design) {
      id
      nombre
      descripcion
      imagen
    }
  }
`,D=c.J1`
  mutation updateDesign($design: UpdatedDesign!) {
    updateDesign(design: $design) {
      id
      nombre
      descripcion
      imagen
    }
  }
`,F=c.J1`
  mutation deleteDesign($id: ID!) {
    deleteDesign(id: $id)
  }
`;var g=l(177),u=l(6707),m=l(2168),h=l(6469),o=l(9417),e=l(4438),v=l(6695);const C=()=>["create-design"],M=()=>[10,20,50,100,200,500,1e3,2e3,5e3];function I(i,d){if(1&i&&(e.j41(0,"div",36),e.EFF(1),e.nrm(2,"button",37),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function k(i,d){if(1&i&&(e.j41(0,"div",38),e.EFF(1),e.nrm(2,"button",37),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function E(i,d){if(1&i&&e.nrm(0,"img",42),2&i){const t=e.XpG().$implicit;e.Y8G("src",t.imagen,e.B4B)}}function j(i,d){if(1&i){const t=e.RV6();e.j41(0,"tr")(1,"td",15),e.EFF(2),e.k0s(),e.j41(3,"td",15),e.EFF(4),e.k0s(),e.j41(5,"td",15),e.EFF(6),e.k0s(),e.j41(7,"td",15),e.DNE(8,E,1,1,"img",39),e.k0s(),e.j41(9,"td",15)(10,"button",40),e.bIt("click",function(){const s=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.editarDesign(s))}),e.EFF(11,"Editar"),e.k0s(),e.j41(12,"button",41),e.bIt("click",function(){const s=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.deleteDesign(s.id))}),e.EFF(13,"Eliminar"),e.k0s()()()}if(2&i){const t=d.$implicit;e.R7$(2),e.JRh(t.id),e.R7$(2),e.JRh(t.nombre),e.R7$(2),e.JRh(t.descripcion),e.R7$(2),e.Y8G("ngIf",t.imagen)}}function y(i,d){if(1&i&&(e.j41(0,"div",12),e.EFF(1),e.nrm(2,"button",13),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function R(i,d){if(1&i&&(e.j41(0,"div",14),e.EFF(1),e.nrm(2,"button",13),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}const S=[{path:"",component:(()=>{class i{constructor(t){this.apollo=t,this.successMessage=null,this.errorMessage=null,this.selectedDesign={},this.designs=[],this.pageInfo={},this.pageSize=10,this.paginaActual=0}ngOnInit(){this.loadData()}loadData(){this.apollo.watchQuery({query:b.d,variables:{page:this.paginaActual,size:this.pageSize}}).valueChanges.subscribe(t=>{console.log(t),this.designs=t?.data?.getDesigns?.items||[],this.pageInfo=t?.data?.getDesigns?.pageInfo||{}})}onPageChange(t){this.pageSize=t.pageSize,this.paginaActual=t.pageIndex,this.loadData()}deleteDesign(t){this.apollo.mutate({mutation:F,variables:{id:t}}).subscribe({next:n=>{!0===n.data.deleteDesign?(console.log("Device eliminada:",n),this.successMessage="eliminada con \xe9xito!",this.designs=this.designs.filter(s=>s.id!==t)):this.errorMessage="Error al eliminar  Por favor, intente nuevamente."},error:n=>{this.errorMessage="Error al eliminar. Por favor, intente nuevamente.",console.error("Error:",n)}})}saveDesign(){console.log("guardado:",this.selectedDesign),this.updateDesign(this.selectedDesign);const t=document.getElementById("editDesignModal");h.aF.getInstance(t)?.hide();const s=this.designs.findIndex(a=>a.id===this.selectedDesign.id);s>-1&&(this.designs[s]={...this.selectedDesign})}onFileChange(t){const n=t.target.files[0];if(n){const s=new FileReader;s.readAsDataURL(n),s.onload=()=>{this.selectedDesign.imagen=s.result}}}updateDesign(t){this.apollo.mutate({mutation:D,variables:{design:{id:t.id,nombre:t.nombre,descripcion:t.descripcion,imagen:t.imagen}}}).subscribe({next:n=>{this.successMessage="actualizado con \xe9xito!",this.errorMessage=null,setTimeout(()=>this.successMessage=null,3e3)},error:n=>{this.errorMessage="Error al editar Por favor, intente nuevamente.",this.successMessage=null,console.error("Error:",n)}})}editarDesign(t){this.selectedDesign={...t};const n=document.getElementById("editDesignModal");new h.aF(n).show();const a=document.querySelector(".modal-backdrop");a&&a.remove()}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(c.Ic))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-design"]],standalone:!0,features:[e.aNF],decls:62,vars:12,consts:[["id","contenido_principal",2,"background-color","white"],[1,"row","justify-content-center"],[1,"col","text-center"],[1,"box-title","text-secondary",2,"font-size","30px"],["class","alert alert-success alert-dismissible fade show mt-3","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show mt-3","role","alert",4,"ngIf"],[1,"row","mt-3"],[1,"col-md-12"],[1,"btn","btn-success","btn-sm","mr-2",3,"routerLink"],[1,"card","border-green"],[1,"card-body","p-3"],[1,"table-responsive"],["id","tabla-empresas",1,"table","table-bordered","table-striped","table-condensed"],["colspan","5"],[1,"bg-light"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["id","editDesignModal","tabindex","-1","aria-labelledby","editDesignModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","editDesignModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[3,"ngSubmit"],[1,"modal-body"],[1,"mb-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","name","nombre","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","descripcion",1,"form-label"],["id","descripcion","name","descripcion","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","imagen",1,"form-label"],["type","file","id","imagen",1,"form-control",3,"change"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show","mt-3"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show","mt-3"],["alt","Imagen","style","max-width: 100px; max-height: 100px;",3,"src",4,"ngIf"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger",3,"click"],["alt","Imagen",2,"max-width","100px","max-height","100px",3,"src"]],template:function(n,s){1&n&&(e.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4," Gestionar Dise\xf1os "),e.k0s(),e.DNE(5,I,3,1,"div",4)(6,k,3,1,"div",5),e.k0s()(),e.j41(7,"div",6)(8,"div",7)(9,"div")(10,"a",8),e.EFF(11,"Crear"),e.k0s()()()(),e.j41(12,"div",6)(13,"div",7)(14,"div",9)(15,"div",10)(16,"div",11)(17,"table",12)(18,"thead")(19,"tr"),e.nrm(20,"th",13),e.k0s()(),e.j41(21,"thead",14)(22,"tr")(23,"th",15),e.EFF(24,"ID"),e.k0s(),e.j41(25,"th",15),e.EFF(26,"Nmbre"),e.k0s(),e.j41(27,"th",15),e.EFF(28,"Descripcion"),e.k0s(),e.j41(29,"th",15),e.EFF(30,"Imagen"),e.k0s(),e.j41(31,"th",15),e.EFF(32,"Accion"),e.k0s()()(),e.j41(33,"tbody"),e.DNE(34,j,14,4,"tr",16),e.k0s()(),e.j41(35,"mat-paginator",17),e.bIt("page",function(r){return s.onPageChange(r)}),e.k0s()()()()()()(),e.j41(36,"div",18)(37,"div",19)(38,"div",20)(39,"div",21)(40,"h5",22),e.EFF(41,"Editar Dise\xf1o"),e.k0s(),e.nrm(42,"button",23),e.k0s(),e.j41(43,"form",24),e.bIt("ngSubmit",function(){return s.saveDesign()}),e.j41(44,"div",25)(45,"div",26)(46,"label",27),e.EFF(47,"Nombre"),e.k0s(),e.j41(48,"input",28),e.mxI("ngModelChange",function(r){return e.DH7(s.selectedDesign.nombre,r)||(s.selectedDesign.nombre=r),r}),e.k0s()(),e.j41(49,"div",26)(50,"label",29),e.EFF(51,"Descripci\xf3n"),e.k0s(),e.j41(52,"textarea",30),e.mxI("ngModelChange",function(r){return e.DH7(s.selectedDesign.descripcion,r)||(s.selectedDesign.descripcion=r),r}),e.k0s()(),e.j41(53,"div",26)(54,"label",31),e.EFF(55,"Imagen"),e.k0s(),e.j41(56,"input",32),e.bIt("change",function(r){return s.onFileChange(r)}),e.k0s()()(),e.j41(57,"div",33)(58,"button",34),e.EFF(59,"Cerrar"),e.k0s(),e.j41(60,"button",35),e.EFF(61,"Guardar cambios"),e.k0s()()()()()()),2&n&&(e.R7$(5),e.Y8G("ngIf",s.successMessage),e.R7$(),e.Y8G("ngIf",s.errorMessage),e.R7$(4),e.Y8G("routerLink",e.lJ4(10,C)),e.R7$(24),e.Y8G("ngForOf",s.designs),e.R7$(),e.Y8G("length",s.pageInfo.totalElementos)("pageSize",s.pageSize)("pageIndex",s.paginaActual)("pageSizeOptions",e.lJ4(11,M)),e.R7$(13),e.R50("ngModel",s.selectedDesign.nombre),e.R7$(4),e.R50("ngModel",s.selectedDesign.descripcion))},dependencies:[g.MD,g.Sq,g.bT,u.G,v.iy,m.iI,m.Wk,o.YN,o.qT,o.me,o.BC,o.cb,o.YS,o.vS,o.cV],encapsulation:2})}}return i})(),data:{titulo:"Designs"}},{path:"create-design",component:(()=>{class i{constructor(t){this.apollo=t,this.successMessage=null,this.errorMessage=null,this.imagenBase64=null,this.form=new o.gE({nombre:new o.MJ("",[o.k0.required]),descripcion:new o.MJ("",[o.k0.required]),imagen:new o.MJ("",[o.k0.required])})}onFileChange(t){const n=t.target;if(n?.files?.length){const s=n.files[0];if("image/png"!==s.type)return void(this.errorMessage="Solo se permiten im\xe1genes en formato PNG.");const a=new FileReader;a.onload=()=>{const r=a.result;this.form.get("imagen")?.setValue(r),console.log("Imagen Base64:",r)},a.onerror=()=>{this.errorMessage="Ocurri\xf3 un error al procesar la imagen. Intente nuevamente."},a.readAsDataURL(s)}else this.errorMessage="Por favor seleccione un archivo v\xe1lido."}ngOnInit(){}onSubmit(){if(this.form.valid&&this.form.get("imagen")?.value){const{nombre:t,descripcion:n,imagen:s}=this.form.value;this.createDesign({nombre:t,descripcion:n,imagen:s})}else this.errorMessage="Por favor complete todos los campos y cargue una imagen v\xe1lida.",console.log("Formulario inv\xe1lido:",this.form.value)}createDesign(t){this.apollo.mutate({mutation:f,variables:{design:t}}).subscribe({next:n=>{this.successMessage="\xa1Dise\xf1o creado con \xe9xito!",this.errorMessage=null,this.form.reset(),this.imagenBase64=null,setTimeout(()=>{this.successMessage=null},5e3)},error:n=>{this.errorMessage="Error al crear el dise\xf1o. Por favor, intente nuevamente.",this.successMessage=null,console.error("Error:",n)}})}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(c.Ic))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-crear-device"]],standalone:!0,features:[e.aNF],decls:18,vars:3,consts:[[1,"container","mt-5"],["class","alert alert-success alert-dismissible fade show mt-3","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show mt-3","role","alert",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre","placeholder","Ingrese el nombre ",1,"form-control"],["for","descripcion"],["type","text","id","descripcion","formControlName","descripcion","placeholder","Ingrese descripci\xf3n ",1,"form-control"],["for","imagen"],["type","file","id","imagen","accept","image/png",1,"form-control",3,"change"],["type","submit",1,"btn","btn-primary","mt-3"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show","mt-3"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show","mt-3"]],template:function(n,s){1&n&&(e.j41(0,"div",0),e.DNE(1,y,3,1,"div",1)(2,R,3,1,"div",2),e.j41(3,"form",3),e.bIt("ngSubmit",function(){return s.onSubmit()}),e.j41(4,"div",4)(5,"label",5),e.EFF(6,"Nombre:"),e.k0s(),e.nrm(7,"input",6),e.k0s(),e.j41(8,"div",4)(9,"label",7),e.EFF(10,"Descripci\xf3n:"),e.k0s(),e.nrm(11,"input",8),e.k0s(),e.j41(12,"div",4)(13,"label",9),e.EFF(14,"Cargar imagen:"),e.k0s(),e.j41(15,"input",10),e.bIt("change",function(r){return s.onFileChange(r)}),e.k0s()(),e.j41(16,"button",11),e.EFF(17,"Crear Dise\xf1o"),e.k0s()()()),2&n&&(e.R7$(),e.Y8G("ngIf",s.successMessage),e.R7$(),e.Y8G("ngIf",s.errorMessage),e.R7$(),e.Y8G("formGroup",s.form))},dependencies:[m.iI,u.G,g.MD,g.bT,o.X1,o.qT,o.me,o.BC,o.cb,o.j4,o.JD],encapsulation:2})}}return i})(),data:{titulo:"Crear Dise\xf1o"}}]}}]);