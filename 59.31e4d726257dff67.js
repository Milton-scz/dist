"use strict";(self.webpackChunkSpike=self.webpackChunkSpike||[]).push([[59],{9059:(z,F,l)=>{l.r(F),l.d(F,{ShirtRoutes:()=>O});var C=l(9283),p=l(1806);const E=p.J1`
  mutation createShirt($shirt: NewShirt!) {
    createShirt(shirt: $shirt) {
      id
      nombre
      descripcion
      talla
      precio
      stock
  design{
      id
      nombre
      descripcion
      imagen

      }
    }
  }
`,M=p.J1`
  mutation updateShirt($shirt: UpdatedShirt!) {
    updateShirt(shirt: $shirt) {
      id
      nombre
      descripcion
      talla
      precio
      stock
  design{
      id
      nombre
      descripcion
      imagen

      }
    }
  }
`,_=p.J1`
  mutation deleteShirt($id: ID!) {
    deleteShirt(id: $id)
  }
`;var h=l(177),S=l(6707),f=l(2168),v=l(6469),s=l(9417),e=l(4438),j=l(6695);const I=()=>["create-shirt"],y=()=>[10,20,50,100,200,500,1e3,2e3,5e3];function R(a,d){if(1&a&&(e.j41(0,"div",42),e.EFF(1),e.nrm(2,"button",43),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function w(a,d){if(1&a&&(e.j41(0,"div",44),e.EFF(1),e.nrm(2,"button",43),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function D(a,d){if(1&a&&e.nrm(0,"img",48),2&a){const t=e.XpG().$implicit;e.Y8G("src",t.design.imagen,e.B4B)}}function x(a,d){if(1&a&&e.nrm(0,"img",48),2&a){const t=e.XpG().$implicit;e.Y8G("src",t.imagen,e.B4B)}}function T(a,d){if(1&a){const t=e.RV6();e.j41(0,"tr")(1,"td",15),e.EFF(2),e.k0s(),e.j41(3,"td",15),e.EFF(4),e.k0s(),e.j41(5,"td",15),e.EFF(6),e.k0s(),e.j41(7,"td",15),e.EFF(8),e.k0s(),e.j41(9,"td",15),e.EFF(10),e.k0s(),e.j41(11,"td",15),e.EFF(12),e.k0s(),e.j41(13,"td",15),e.DNE(14,D,1,1,"img",45),e.k0s(),e.j41(15,"td",15),e.DNE(16,x,1,1,"img",45),e.k0s(),e.j41(17,"td",15)(18,"button",46),e.bIt("click",function(){const n=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.editarShirt(n))}),e.EFF(19,"Editar"),e.k0s(),e.j41(20,"button",47),e.bIt("click",function(){const n=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.deleteShirt(n.id))}),e.EFF(21,"Eliminar"),e.k0s()()()}if(2&a){const t=d.$implicit;e.R7$(2),e.JRh(t.id),e.R7$(2),e.JRh(t.nombre),e.R7$(2),e.JRh(t.descripcion),e.R7$(2),e.JRh(t.talla),e.R7$(2),e.JRh(t.precio),e.R7$(2),e.JRh(t.stock),e.R7$(2),e.Y8G("ngIf",t.design.imagen),e.R7$(2),e.Y8G("ngIf",t.imagen)}}let G=(()=>{class a{constructor(t){this.apollo=t,this.successMessage=null,this.errorMessage=null,this.shirts=[],this.pageInfo={},this.pageSize=10,this.paginaActual=0,this.selectedShirt={}}ngOnInit(){this.loadData()}loadData(){this.apollo.watchQuery({query:C.dK,variables:{page:this.paginaActual,size:this.pageSize}}).valueChanges.subscribe(t=>{console.log(t),this.shirts=t?.data?.getShirts?.items||[],this.pageInfo=t?.data?.getShirts?.pageInfo||{}})}onPageChange(t){this.pageSize=t.pageSize,this.paginaActual=t.pageIndex,this.loadData()}deleteShirt(t){this.apollo.mutate({mutation:_,variables:{id:t}}).subscribe({next:i=>{!0===i.data.deleteShirt?(console.log("Habitaci\xf3n eliminada:",i),this.successMessage="Habitaci\xf3n eliminada con \xe9xito!",this.shirts=this.shirts.filter(n=>n.id!==t)):this.errorMessage="Error al eliminar la habitaci\xf3n. Por favor, intente nuevamente."},error:i=>{this.errorMessage="Error al eliminar la habitaci\xf3n. Por favor, intente nuevamente.",console.error("Error:",i)}})}saveShirt(){console.log("guardado:",this.selectedShirt),this.updateShirt(this.selectedShirt);const t=document.getElementById("editShirtModal");v.aF.getInstance(t)?.hide();const n=this.shirts.findIndex(o=>o.id===this.selectedShirt.id);n>-1&&(this.shirts[n]={...this.selectedShirt})}onFileChange(t){const i=t.target.files[0];if(i){const n=new FileReader;n.readAsDataURL(i),n.onload=()=>{this.selectedShirt.imagen=n.result}}}updateShirt(t){this.apollo.mutate({mutation:M,variables:{shirt:{id:t.id,nombre:t.nombre,descripcion:t.descripcion,precio:t.precio,stock:t.stock,imagen:t.imagen,design:{id:t.design.id,nombre:t.design.nombre,descripcion:t.design.descripcion,imagen:t.design.imagen}}}}).subscribe({next:i=>{this.successMessage="actualizado con \xe9xito!",this.errorMessage=null,setTimeout(()=>this.successMessage=null,3e3)},error:i=>{this.errorMessage="Error al editar Por favor, intente nuevamente.",this.successMessage=null,console.error("Error:",i)}})}editarShirt(t){this.selectedShirt={...t};const i=document.getElementById("editShirtModal");new v.aF(i).show();const o=document.querySelector(".modal-backdrop");o&&o.remove()}static{this.\u0275fac=function(i){return new(i||a)(e.rXU(p.Ic))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-shirt"]],standalone:!0,features:[e.aNF],decls:82,vars:15,consts:[["id","contenido_principal",2,"background-color","white"],[1,"row","justify-content-center"],[1,"col","text-center"],[1,"box-title","text-secondary",2,"font-size","30px"],["class","alert alert-success alert-dismissible fade show mt-3","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show mt-3","role","alert",4,"ngIf"],[1,"row","mt-3"],[1,"col-md-12"],[1,"btn","btn-success","btn-sm","mr-2",3,"routerLink"],[1,"card","border-green"],[1,"card-body","p-3"],[1,"table-responsive"],["id","tabla-habitaciones",1,"table","table-bordered","table-striped","table-condensed"],["colspan","7"],[1,"bg-light"],[1,"text-center"],[4,"ngFor","ngForOf"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["id","editShirtModal","tabindex","-1","aria-labelledby","editShirtModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","editShirtModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[3,"ngSubmit"],[1,"modal-body"],[1,"mb-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","name","nombre","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","descripcion",1,"form-label"],["id","descripcion","name","descripcion","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","talla",1,"form-label"],["type","text","id","talla","name","talla","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","precio",1,"form-label"],["type","number","id","precio","name","precio","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","stock",1,"form-label"],["type","number","id","stock","name","stock","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","imagen",1,"form-label"],["type","file","id","imagen",1,"form-control",3,"change"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show","mt-3"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show","mt-3"],["alt","Imagen","style","max-width: 100px; max-height: 100px;",3,"src",4,"ngIf"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-danger",3,"click"],["alt","Imagen",2,"max-width","100px","max-height","100px",3,"src"]],template:function(i,n){1&i&&(e.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4," Gestionar Poleras "),e.k0s(),e.DNE(5,R,3,1,"div",4)(6,w,3,1,"div",5),e.k0s()(),e.j41(7,"div",6)(8,"div",7)(9,"div")(10,"a",8),e.EFF(11,"Agregar "),e.k0s()()()(),e.j41(12,"div",6)(13,"div",7)(14,"div",9)(15,"div",10)(16,"div",11)(17,"table",12)(18,"thead")(19,"tr"),e.nrm(20,"th",13),e.k0s()(),e.j41(21,"thead",14)(22,"tr")(23,"th",15),e.EFF(24,"ID"),e.k0s(),e.j41(25,"th",15),e.EFF(26,"Nombre"),e.k0s(),e.j41(27,"th",15),e.EFF(28,"Descripcion"),e.k0s(),e.j41(29,"th",15),e.EFF(30,"Talla"),e.k0s(),e.j41(31,"th",15),e.EFF(32,"Precio"),e.k0s(),e.j41(33,"th",15),e.EFF(34,"Stock"),e.k0s(),e.j41(35,"th",15),e.EFF(36,"Dise\xf1o"),e.k0s(),e.j41(37,"th",15),e.EFF(38,"Imagen"),e.k0s(),e.j41(39,"th",15),e.EFF(40,"Acci\xf3n"),e.k0s()()(),e.j41(41,"tbody"),e.DNE(42,T,22,8,"tr",16),e.k0s()(),e.j41(43,"mat-paginator",17),e.bIt("page",function(r){return n.onPageChange(r)}),e.k0s()()()()()()(),e.j41(44,"div",18)(45,"div",19)(46,"div",20)(47,"div",21)(48,"h5",22),e.EFF(49,"Editar Polera"),e.k0s(),e.nrm(50,"button",23),e.k0s(),e.j41(51,"form",24),e.bIt("ngSubmit",function(){return n.saveShirt()}),e.j41(52,"div",25)(53,"div",26)(54,"label",27),e.EFF(55,"Nombre"),e.k0s(),e.j41(56,"input",28),e.mxI("ngModelChange",function(r){return e.DH7(n.selectedShirt.nombre,r)||(n.selectedShirt.nombre=r),r}),e.k0s()(),e.j41(57,"div",26)(58,"label",29),e.EFF(59,"Descripci\xf3n"),e.k0s(),e.j41(60,"textarea",30),e.mxI("ngModelChange",function(r){return e.DH7(n.selectedShirt.descripcion,r)||(n.selectedShirt.descripcion=r),r}),e.k0s()(),e.j41(61,"div",26)(62,"label",31),e.EFF(63,"Talla"),e.k0s(),e.j41(64,"input",32),e.mxI("ngModelChange",function(r){return e.DH7(n.selectedShirt.talla,r)||(n.selectedShirt.talla=r),r}),e.k0s()(),e.j41(65,"div",26)(66,"label",33),e.EFF(67,"Precio"),e.k0s(),e.j41(68,"input",34),e.mxI("ngModelChange",function(r){return e.DH7(n.selectedShirt.precio,r)||(n.selectedShirt.precio=r),r}),e.k0s()(),e.j41(69,"div",26)(70,"label",35),e.EFF(71,"Stock"),e.k0s(),e.j41(72,"input",36),e.mxI("ngModelChange",function(r){return e.DH7(n.selectedShirt.stock,r)||(n.selectedShirt.stock=r),r}),e.k0s()(),e.j41(73,"div",26)(74,"label",37),e.EFF(75,"Imagen"),e.k0s(),e.j41(76,"input",38),e.bIt("change",function(r){return n.onFileChange(r)}),e.k0s()()(),e.j41(77,"div",39)(78,"button",40),e.EFF(79,"Cerrar"),e.k0s(),e.j41(80,"button",41),e.EFF(81,"Guardar cambios"),e.k0s()()()()()()),2&i&&(e.R7$(5),e.Y8G("ngIf",n.successMessage),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(4),e.Y8G("routerLink",e.lJ4(13,I)),e.R7$(32),e.Y8G("ngForOf",n.shirts),e.R7$(),e.Y8G("length",n.pageInfo.totalElementos)("pageSize",n.pageSize)("pageIndex",n.paginaActual)("pageSizeOptions",e.lJ4(14,y)),e.R7$(13),e.R50("ngModel",n.selectedShirt.nombre),e.R7$(4),e.R50("ngModel",n.selectedShirt.descripcion),e.R7$(4),e.R50("ngModel",n.selectedShirt.talla),e.R7$(4),e.R50("ngModel",n.selectedShirt.precio),e.R7$(4),e.R50("ngModel",n.selectedShirt.stock))},dependencies:[h.MD,h.Sq,h.bT,S.G,j.iy,f.iI,f.Wk,s.YN,s.qT,s.me,s.Q0,s.BC,s.cb,s.YS,s.vS,s.cV],encapsulation:2})}}return a})();var $=l(111);const N=["canvasElement"];function J(a,d){if(1&a&&(e.j41(0,"div",30),e.EFF(1),e.nrm(2,"button",31),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.successMessage," ")}}function Y(a,d){if(1&a&&(e.j41(0,"div",32),e.EFF(1),e.nrm(2,"button",31),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}function B(a,d){if(1&a&&(e.j41(0,"option",33),e.EFF(1),e.k0s()),2&a){const t=d.$implicit;e.Y8G("value",t.nombre),e.R7$(),e.JRh(t.nombre)}}const O=[{path:"",component:G,data:{titulo:"Shirt"}},{path:"create-shirt",component:(()=>{class a{constructor(t){this.apollo=t,this.successMessage=null,this.errorMessage=null,this.designs=[],this.selectedImage=null,this.selectedDesign=null,this.context=null,this.form=new s.gE({nombre:new s.MJ("",[s.k0.required]),descripcion:new s.MJ("",[s.k0.required,s.k0.min(1)]),talla:new s.MJ("",[s.k0.required]),precio:new s.MJ(0,[s.k0.required,s.k0.min(0)]),stock:new s.MJ(0,[s.k0.required]),design:new s.MJ(null),imagen:new s.MJ(null)})}ngOnInit(){this.loadDesigns();const t=this.canvasElement?.nativeElement;t&&(this.context=t.getContext("2d"))}loadDesigns(){this.apollo.watchQuery({query:$.N}).valueChanges.subscribe(t=>{this.designs=t?.data?.getAllDesigns||[]})}onSubmit(){if(this.form.valid){const{nombre:t,precio:i,talla:n,descripcion:o,stock:r}=this.form.value,c=document.getElementById("imageCanvas"),m=c?c.toDataURL("image/png"):null;if(!m)return void console.error("No se pudo obtener la imagen del canvas.");const g=this.selectedDesign?{id:this.selectedDesign.id||"",nombre:this.selectedDesign.nombre||"",descripcion:this.selectedDesign.descripcion||"",imagen:this.selectedDesign.imagen||""}:null;if(!g)return void console.error("El dise\xf1o es obligatorio.");const u={nombre:t,descripcion:o,precio:parseFloat(i),stock:parseInt(r,10),talla:n,imagen:m,design:g};this.createShirt(u)}else console.error("Formulario inv\xe1lido. Por favor, complete todos los campos.")}onFileChange(t){const i=t.target;if(i?.files?.length){const n=i.files[0];if("image/png"!==n.type)return void(this.errorMessage="Solo se permiten im\xe1genes en formato PNG.");const o=new FileReader;o.onload=()=>{const r=o.result;this.form.get("imagen")?.setValue(r);const c=document.getElementById("imageCanvas"),m=c.getContext("2d");if(m){const g=new Image;g.onload=()=>{c.width=500,c.height=500,m.clearRect(0,0,500,500),m.drawImage(g,0,0,500,500)},g.src=r}},o.onerror=()=>{this.errorMessage="Ocurri\xf3 un error al procesar la imagen. Intente nuevamente."},o.readAsDataURL(n)}else this.errorMessage="Por favor seleccione un archivo v\xe1lido."}onDesignSelect(t){const i=t.target.value,n=this.designs.find(o=>o.nombre===i);this.selectedDesign=n,n&&this.drawDesignOnCanvas(n.imagen)}drawDesignOnCanvas(t){const i=document.getElementById("imageCanvas"),n=i.getContext("2d");if(n){const o=new Image;o.onload=()=>{const r=i.width,c=i.height,u=.4*Math.min(r/o.width,c/o.height),b=o.width*u,k=o.height*u;n.drawImage(o,(r-b)/2,(c-k)/2,b,k)},o.src=t}}drawImageOnCanvas(t){const i=document.getElementById("imageCanvas"),n=i.getContext("2d");if(n){const o=new Image;o.onload=()=>{n.drawImage(o,0,0,i.width,i.height)},o.src=t}}onDesignChange(){this.selectedDesign=this.form.get("design")?.value}createShirt(t){this.apollo.mutate({mutation:E,variables:{shirt:t}}).subscribe({next:i=>{this.successMessage="creada con \xe9xito!",setTimeout(()=>{this.successMessage=null},5e3),console.log("Camisa creada con \xe9xito:",i),this.resetFormAndCanvas()},error:i=>{console.error("Error al crear la camisa:",i)}})}resetFormAndCanvas(){this.form.reset();const t=document.getElementById("imageCanvas"),i=t.getContext("2d");i&&i.clearRect(0,0,t.width,t.height),console.log("Formulario y canvas limpiados.")}static{this.\u0275fac=function(i){return new(i||a)(e.rXU(p.Ic))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-crear-habitacion"]],viewQuery:function(i,n){if(1&i&&e.GBs(N,5),2&i){let o;e.mGM(o=e.lsd())&&(n.canvasElement=o.first)}},standalone:!0,features:[e.aNF],decls:49,vars:4,consts:[["id","contenido_principal",2,"background-color","white"],["class","alert alert-success alert-dismissible fade show mt-3","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show mt-3","role","alert",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","form-group"],["for","nombre"],["type","text","id","nombre","formControlName","nombre","placeholder","Ingrese el nombre",1,"form-control","form-control-sm"],["for","descripcion"],["id","descripcion","formControlName","descripcion","rows","2","placeholder","Ingrese una descripci\xf3n",1,"form-control","form-control-sm"],["for","talla"],["id","talla","formControlName","talla",1,"form-control","form-control-sm"],["value","","disabled","","selected",""],["value","S"],["value","M"],["value","L"],["value","XL"],["for","stock"],["type","number","id","stock","formControlName","stock","placeholder","Ingrese la cantidad en stock",1,"form-control","form-control-sm"],["for","precio"],["type","number","id","precio","formControlName","precio","placeholder","Ingrese la cantidad en stock",1,"form-control","form-control-sm"],["for","imagen"],["type","file","id","imagen","accept","image/png",1,"form-control","form-control-sm",3,"change"],["for","design"],["id","design","formControlName","design",1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","canvas-container","mt-3"],["id","imageCanvas","width","500","height","500",2,"border","1px solid #ccc"],[1,"form-group","center-button","mt-3"],["type","submit",1,"btn","btn-primary"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show","mt-3"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show","mt-3"],[3,"value"]],template:function(i,n){1&i&&(e.j41(0,"section",0),e.DNE(1,J,3,1,"div",1)(2,Y,3,1,"div",2),e.j41(3,"form",3),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(4,"div",4)(5,"div",5)(6,"label",6),e.EFF(7,"Nombre:"),e.k0s(),e.nrm(8,"input",7),e.k0s(),e.j41(9,"div",5)(10,"label",8),e.EFF(11,"Descripci\xf3n:"),e.k0s(),e.nrm(12,"textarea",9),e.k0s(),e.j41(13,"div",5)(14,"label",10),e.EFF(15,"Talla:"),e.k0s(),e.j41(16,"select",11)(17,"option",12),e.EFF(18,"Seleccione una talla"),e.k0s(),e.j41(19,"option",13),e.EFF(20,"S"),e.k0s(),e.j41(21,"option",14),e.EFF(22,"M"),e.k0s(),e.j41(23,"option",15),e.EFF(24,"L"),e.k0s(),e.j41(25,"option",16),e.EFF(26,"XL"),e.k0s()()(),e.j41(27,"div",5)(28,"label",17),e.EFF(29,"Stock:"),e.k0s(),e.nrm(30,"input",18),e.k0s(),e.j41(31,"div",5)(32,"label",19),e.EFF(33,"Precio:"),e.k0s(),e.nrm(34,"input",20),e.k0s(),e.j41(35,"div",5)(36,"label",21),e.EFF(37,"Cargar imagen:"),e.k0s(),e.j41(38,"input",22),e.bIt("change",function(r){return n.onFileChange(r)}),e.k0s()(),e.j41(39,"div",5)(40,"label",23),e.EFF(41,"Seleccionar dise\xf1o:"),e.k0s(),e.j41(42,"select",24),e.bIt("change",function(r){return n.onDesignSelect(r)}),e.DNE(43,B,2,2,"option",25),e.k0s()()(),e.j41(44,"div",26),e.nrm(45,"canvas",27),e.k0s(),e.j41(46,"div",28)(47,"button",29),e.EFF(48,"Crear"),e.k0s()()()()),2&i&&(e.R7$(),e.Y8G("ngIf",n.successMessage),e.R7$(),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("formGroup",n.form),e.R7$(40),e.Y8G("ngForOf",n.designs))},dependencies:[f.iI,S.G,h.MD,h.Sq,h.bT,s.X1,s.qT,s.xH,s.y7,s.me,s.Q0,s.wz,s.BC,s.cb,s.j4,s.JD],styles:[".canvas-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:500px}.center-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-control-sm[_ngcontent-%COMP%]{width:200px;font-size:14px}canvas[_ngcontent-%COMP%]{display:block}"]})}}return a})(),data:{titulo:"Crear Shirt"}}]}}]);